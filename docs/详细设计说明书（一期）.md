# 算法平台项目-详细设计说明书

------

[TOC]

## 1. 概述
### 1.1 需求概述
> 提供老师和学生等算法重业人员开发算法和发布算法等

### 1.2 运行环境
#### 1.2.1 软件环境

|类型|信息|
|-----  |-----|
|数据库|MySQL、Redis|
|应用服务器|Tomcat|
|开发工具|Eclipse、IntelliJ IDEA|

#### 1.2.2 硬件环境
微服务部署。
### 1.3 依赖关系
#### 1.3.1 外部依赖

除系统数据库外，还依赖于文献。
#### 1.3.2 内部依赖
无。

## 2 系统总体设计
### 2.1	系统架构

![系统架构图](imgs/architecture.png?raw=true)

## 3 模块接口设计
### 3.1	算法编辑模块
**1. 请求URL**

–	请求URL：http://192.168.1.94/algorithm/{user}/{modId}/edit
–	请求方式：GET
–	参数如下：

|参数名|必选|类型|说明|
|-----  |----- |----- |-----   |
|user |是  |String | 当前登录用户Code|
|modId |是  |String | 编辑算法ID|

**2. 响应实例**

 ```
 {
     "code" : "200",
     "msg" : "成功",
     "detail" : {
     },
     "data" : "true"
 }

 ```
–	结果如下：

|字段名|类型|说明|
|-----  |----- |-----   |
|modId |String | 算法ID，英文名称|
|modName |String | 算法中文名称|
|latestVersion |String | 最新提交版本|
|latestCommit |String | 最新提交Git版本号|
|listpath |String | 文件集合|
### 3.2	修改信息接口
**1. 请求URL**

–	请求URL：http://192.168.1.107/algorithm/updateUserInformation
–	请求方式：POST
–	参数如下：

|参数名|必选|类型|说明|
|-----  |----- |----- |-----   |
|usrName |是  |String | 用户中文名字|
|usrCode |是  |String | 用户英文名字|
|email |是  |String | 用户的邮箱|
|needNotify |是  |String | 用户是采用邮箱还是短信方式|
|telephone |是  |String | 用户电话|
|usrUrl |是  |String | 用户个人主要|
**2. 响应实例**

 ```
 {
     "code" : "200",
     "msg" : "成功",
     "detail":null,
     "data" : "SUCCESS"
 }
### 3.3	更改密码接口
**1. 请求URL**

–	请求URL：http://192.168.1.107/algorithm/changePassword
–	请求方式：put
–	参数如下：

|参数名|必选|类型|说明|
|-----  |----- |----- |-----   |
|passwd |是  |String | 原始密码|
|newPassword |是  |String |新密码|
|confirmPassword |是  |String | 确认新密码|

**2. 响应实例**

 ```
 {
     "code" : "200",
     "msg" : "成功",
     "detail":null,
     "data" : "SUCCESS"
 }
 
 ### 3.4	账户查询
 **1. 请求URL**
 
 –	请求URL：http://192.168.1.47/algorithms/accountInformation
 –	请求方式：GET
 –	参数如下：
 
 |参数名|必选|类型|说明|
 |-----  |----- |----- |-----   |


 
 **2. 响应实例**
 
  ```
  {
      "code" : "200",
      "msg" : "成功",
      "detail":null,
      "data" :{"accSn":"aac44b648b10429cbaf85a6ae0f61165",
              "usrSn":"aac44b648b10429cbaf85a6ae0f63a65",
              "cashBal":22.0,
              "earnBal":33.0,
              "freeBal":44.0,
              "freeSetTime":null,
              "cash":"45.00"}
  }
  
  –	结果如下：
  
  |字段名|类型|说明|
  |-----  |----- |-----   |
  |accSn |String | 账户串号|
  |usrSn |String | 用户串号|
  |cashBal |String | 充值账户余额|
  |earnBal |String | 收入账户余额|
  |freeBal |String | 赠送账户余额|
  |cash |String | 已提现金额|

### 3.3	用户注册
 **1. 请求URL**
 
 –	请求URL：http://192.168.1.107/algorithms/register
 –	请求方式：POST
 –	参数如下：
 
 |参数名|必选|类型|说明|
 |-----  |----- |----- |-----   |
 |usrCode |是  |String | 用户注册名字|
 |passwd |是  |String | 密码|
 |usrName |是  |String | 用户中文名字|
 |email |是  |String | 邮件|

 
 **2. 响应实例**
 
  ```
  {
      "code" : "200",
      "msg" : "成功",
      "detail":null,
      "data" :"SUCCESS"
  }
  
  ### 3.4	用户算法使用情况
   **1. 请求URL**
   
   –	请求URL：http://192.168.1.107/algorithms/algorithmRecord
   –	请求方式：POST
   –	参数如下：
   
   |参数名|必选|类型|说明|
   |-----  |----- |----- |-----   |
   |page |是  |String | 页数|
   |rows |是  |String | 每页显示多少|

  
   
   **2. 响应实例**
   
 {
  "code":200,
  "msg":"成功",
  "detail":null,
  "data":[{"umcSn":"aac44b648b10429cbaf85a6ae0111165",
         "verSn":"aac44b648b10429cbaf85a6ae0113aa2",
         "callUsrSn":"aac44b648b10429cbaf85a6ae0113a65",
         "ownerUsrSn":"aac44b648b10429cbaf85asse0113aa5",
         "startTime":null,"endTime":null,"duration":200,
         "billedCallCnt":1,"callPayAmount":20.0,
         "modCallCnt":1000,"page":0,"rows":0,"total":0,
         "modName":"张传智1","createTime":"2017-10-12 04:06:33"},
        {"umcSn":"1","verSn":"aac44b648b10429cbaf85a6ae0113aa5",
        "callUsrSn":"aac44b648b10429cbaf85a6ae0113a65",
        "ownerUsrSn":null,"startTime":null,"endTime":null,
        "duration":300,"billedCallCnt":2,
        "callPayAmount":30.0,"modCallCnt":2000,"page":0,
        "rows":0,"total":0,"modName":"张传智",
        "createTime":"2017-10-11 04:07:37"}]
 }
 
   –	结果如下：
   
   |字段名|类型|说明|
   |-----  |----- |-----   |
   |umcSn |String | 调用串号|
   |verSn |String | 版本串号|
   |callUsrSn |String | 调用用户串号|
   |ownerUsrSn |String | 算法创建用户串号|
   |createTime |String | 日期|
   |duration |String | 持续时间|
   |modName |String | 调用算法名字|
   |modCallCnt |String | 调用次数|
   |billedCallCnt |String | 付费次数|
   |callPayAmount |String | 费用|
   
    ### 3.5	收益情况
      **1. 请求URL**
      
      –	请求URL：http://192.168.1.107/algorithms/algorithmEarnRecord
      –	请求方式：POST
      –	参数如下：
      
      |参数名|必选|类型|说明|
      |-----  |----- |----- |-----   |
      |page |是  |String | 第几页|
      |rows |是  |String | 每页显示多少|
   
     
      
      **2. 响应实例**
      
    {
        "code":200,
        "msg":"成功",
        "detail":null,
        "data":[{"umcSn":"aac44b648b10429cbaf85a6ae0111165",
        "verSn":"aac44b648b10429cbaf85a6ae0113aa2",
        "callUsrSn":"aac44b648b10429cbaf85a6ae0113a65",
        "ownerUsrSn":"aac44b648b10429cbaf85asse0113aa5",
        "startTime":null,"endTime":null,"duration":200,
        "billedCallCnt":1,"callPayAmount":20.0,
        "modCallCnt":1000,"page":0,"rows":0,
        "total":0,"modName":"张传智1",
        "createTime":"2017-10-12 04:06:33"}]
      }
    
      –	结果如下：
      
      |字段名|类型|说明|
      |-----  |----- |-----   |
      |umcSn |String | 调用串号|
      |verSn |String | 版本串号|
      |callUsrSn |String | 调用用户串号|
      |ownerUsrSn |String | 算法创建用户串号|
      |createTime |String | 日期|
      |duration |String | 持续时间|
      |modName |String | 调用算法名字|
      |modCallCnt |String | 调用次数|
      |billedCallCnt |String | 付费次数|
      |callPayAmount |String | 费用|
      
    ### 3.6	充值记录
      -    包括已经充值和正在充值记录
      **1. 请求URL**
      
      –	请求URL：http://192.168.1.107/algorithms/payRecord
      –	请求方式：POST
      –	参数如下：
      
      |参数名|必选|类型|说明|
      |-----  |----- |----- |-----   |
      |page |是  |String | 第几页|
      |rows |是  |String | 每页显示多少|
    
     
      
      **2. 响应实例**
      
    {
        "code":200,
        "msg":"成功",
        "detail":null,
        "data":[{"traSn":"aac44b648b10429cbaf85a6ae0fe3a65",
        "usrSn":"aac44b648b10429cbaf85a6ae0f63a65","orderId":"",
        "payTime":null,"payNo":"111111",
        "status":"222222",
        "paySrc":"333333",
        "cashPayAmount":null,
        "currency":null,"creditPerUnit":null,"description":null,
        "createTime":1507777028000,"page":0,
        "rows":0,"integral":0,"total":0}]
        }
    
      –	结果如下：
      
      |字段名|类型|说明|
      |-----  |----- |-----   |
      |traSn |String | 交易串号|
      |usrSn |String | 用户串号|
      |payTime |String | 支付时间|
      |status |String | 状态是正在充值还有已经充值|
      |paySrc |String | 充值来源|
      |cashPayAmount |String | 充值金额|
      |currency |String | 支付币种|
      |creditPerUnit |String | 兑换单价|
      |description |String | 描述|
      |integral |String | 充值积分|
      
       ### 3.6	算法详情
            -    算法详情
            **1. 请求URL**
            
            –	请求URL：http://192.168.1.94/algorithms/{usrCode}/{modId}/algorithmdetail
            –	请求方式：get
            –	参数如下：
            
            |参数名|必选|类型|说明|
            |-----  |----- |----- |-----   |
                   
            
            **2. 响应实例**
            
          {
             "code": 200,
              "msg": "请求成功",
              "detail": null,
              "data": {
                "modSn": "2",
                "usrSn": null,
                "lanSn": null,
                "catSn": null,
                "licSn": null,
                "atlSn": null,
                "modName": null,
                "modId": "2",
                "isOpenSrc": null,
                "needWeb": "0",
                "needCallOther": "0",
                "envType": "2",
                "isTrain": null,
                "isColony": null,
                "colonyPlanId": null,
                "modDesc": null,
                "licName": null,
                "lanName": "Javascript",
                "verCode": "010"
                "url":""
                "dataUrl":""
                "usrCode"
              }

            }
          }

   –	结果如下：
      
      |字段名|类型|说明|
      |-----  |----- |-----   |
      |url |String | 返回路径用户名+项目名称+edit|
      |dataUrl |String | 数据地址|
      |usrCode |String | 算法用户名|
      |needWeb |String | 是否要存取网络|
      |needCallOther |String | 是否调用别的算法|
      |env_type |String | 运算环境类型|
      |lic_name |String | 协议名称|
      |lan_name |String | 语言名称|
      |ver_code |String | 版本号|
      |starCnt |String | 收藏总数|
      |followCnt |String | 评论总数|
      |callCnt |String | 调用总数|
      
         ### 3.7	模型详情初始化
                  -    模型详情初始化
                  **1. 请求URL**
                  
                  –	请求URL：http://192.168.1.94/data/queryModelSet
                  –	请求方式：GET
                  –	参数如下：
                  
                  |参数名|必选|类型|说明|
                  |-----  |----- |----- |-----   |
                         
                  
                  **2. 响应实例**
                  
            {
                "code":200,
                "msg":"请求成功",
                "detail":null,
                "data":[
                    {
                        "modelSetSn":"2",
                        "usrSn":"8ec99d9819744a8aa0db947a6be6db4c",
                        "modelSetName":"智能工业",
                        "modelOrderby":"2",
                        "algModelVolist":[
                            {
                                "modelSn":"1",
                                "datSn":"777",
                                "usrSn":"8ec99d9819744a8aa0db947a6be6db4c",
                                "modelSetSn":"2",
                                "verSn":null,
                                "createTime":1510194671000,
                                "modelAddress":"www.baiduMOdie.com",
                                "modelName":null,
                                "modelEnName":null,
                                "modelSize":null,
                                "isOpenSrc":"1",
                                "comment":"测试算法",
                                "dataUrl":null,
                                "page":0,
                                "rows":0,
                                "total":0,
                                "createDate":"2017-11-09 10:31:11",
                                "dataName":"数据1"
                            },
                            {
                                "modelSn":"2",
                                "datSn":"888",
                                "usrSn":"8ec99d9819744a8aa0db947a6be6db4c",
                                "modelSetSn":"2",
                                "verSn":null,
                                "createTime":null,
                                "modelAddress":null,
                                "modelName":null,
                                "modelEnName":null,
                                "modelSize":null,
                                "isOpenSrc":null,
                                "comment":"人脸识别",
                                "dataUrl":null,
                                "page":0,
                                "rows":0,
                                "total":0,
                                "createDate":null,
                                "dataName":"数据2"
                            }
                        ]
                    },
                    {
                        "modelSetSn":"1",
                        "usrSn":"8ec99d9819744a8aa0db947a6be6db4c",
                        "modelSetName":"人脸识别",
                        "modelOrderby":"1",
                        "algModelVolist":null
                    }
                ]
            }

         –	结果如下：
            
            |字段名|类型|说明|
            |-----  |----- |-----   |
            |modelSetName |String | 模型集名称|
            |dataName |String | 算法名称|
            |createDate |String |算法生成时间|
            |modelSize |String | 模型大小|
            |isOpenSrc |String | 是否开源|
            |modelAddress |String | 运算环境类型|
            |comment |String | 备注|
------
  ### 3.8	点击模型集时候触发事件显示模型集详情
                  -    点击模型集时候触发事件显示模型集详情
                  **1. 请求URL**
                  
                  –	请求URL：http://192.168.1.94/data/queryModel
                  –	请求方式：get
                  –	参数如下：
                  
                  |参数名|必选|类型|说明|
                  |-----  |----- |----- |-----   |
                  |modelSetSn |是  |String | 模型串号| 
                  
                  **2. 响应实例**
                  
          {
              "code":200,
              "msg":"请求成功",
              "detail":null,
              "data":[
                  {
                      "modelSn":"1",
                      "datSn":"777",
                      "usrSn":"8ec99d9819744a8aa0db947a6be6db4c",
                      "modelSetSn":"2",
                      "verSn":null,
                      "createTime":1510194671000,
                      "modelAddress":"www.baiduMOdie.com",
                      "modelName":null,
                      "modelEnName":null,
                      "modelSize":"44",
                      "isOpenSrc":"1",
                      "comment":"测试算法",
                      "dataUrl":null,
                      "page":0,
                      "rows":0,
                      "total":0,
                      "createDate":"2017-11-09 10:31:11",
                      "dataName":"数据1"
                  },
                  {
                      "modelSn":"2",
                      "datSn":"888",
                      "usrSn":"8ec99d9819744a8aa0db947a6be6db4c",
                      "modelSetSn":"2",
                      "verSn":null,
                      "createTime":null,
                      "modelAddress":null,
                      "modelName":null,
                      "modelEnName":null,
                      "modelSize":"55",
                      "isOpenSrc":"0",
                      "comment":"人脸识别",
                      "dataUrl":null,
                      "page":0,
                      "rows":0,
                      "total":0,
                      "createDate":null,
                      "dataName":"数据2"
                  }
              ]
          }
          

         –	结果如下：
            
            |字段名|类型|说明|
            |-----  |----- |-----   |
            |dataName |String | 算法名称|
            |createDate |String |算法生成时间|
            |modelSize |String | 模型大小|
            |isOpenSrc |String | 是否开源|
            |modelAddress |String | 运算环境类型|
            |comment |String | 备注|
            
     ### 3.9	删除模型详情一条记录
          -    删除模型详情一条记录
          **1. 请求URL**
          
          –	请求URL：http://192.168.1.94/data/deleteModel
          –	请求方式：del
          –	参数如下：
          
          |参数名|必选|类型|说明|
          |-----  |----- |----- |-----   |
          |modelSn |String | 模型串号|  
          
          **2. 响应实例**
          
      
        {
            "code":200,
            "msg":"请求成功",
            "detail":null,
            "data":null
        }
       |字段名|类型|说明|
          |-----  |----- |-----   |
           data    object 1代表删除0代表有数据列表无法删除

 –	结果如下：
    
    |字段名|类型|说明|
    |-----  |----- |-----   |
                        
    ### 3.8	删除模型集
              -    删除模型集
              **1. 请求URL**
              
              –	请求URL：http://192.168.1.94/data/deleteModelSet
              –	请求方式：del
              –	参数如下：
              
              |参数名|必选|类型|说明|
              |-----  |----- |----- |-----   |
              |modelSetSn |String | 模型集串号|  
              
              **2. 响应实例**
              
          
            {
                "code":200,
                "msg":"请求成功",
                "detail":null,
                "data":1
            }

     –	结果如下：
        
        |字段名|类型|说明|
        |-----  |----- |-----   |
         data    object 1代表删除0代表有数据列表无法删除
                 
    ###  3.9	增加模型集
           -    增加模型集
           **1. 请求URL**
           
           –	请求URL：http://192.168.1.94/data/addModelSet
           –	请求方式：GET
           –	参数如下：
           
           |参数名|必选|类型|说明|
           |-----  |----- |----- |-----   |
           |modelSetName |String | 模型名字|  
           
           **2. 响应实例**
           
       
         {
             "code":200,
             "msg":"请求成功",
             "detail":null,
             "data":1
         }
      ###  4.0	算法详情模型数据
         -    算法详情模型数据
         **1. 请求URL**
         
         –	请求URL：http://192.168.1.94/data/{usrCode}/{modId}/modeldata
         –	请求方式：POST
         –	参数如下：
         
         |参数名|必选|类型|说明|
         |-----  |----- |----- |-----   |
         
         **2. 响应实例**
         
     
      {
        "code": 200,
        "msg": "请求成功",
        "detail": null,
        "data": [
          {
            "modelSn": null,
            "datSn": null,
            "usrSn": null,
            "modelSetSn": null,
            "verSn": null,
            "createTime": 1510252271000,
            "modelAddress": "www.baiduMOdie.com",
            "modelName": null,
            "modelEnName": null,
            "modelSize": null,
            "isOpenSrc": "1",
            "comment": "测试算法",
            "dataUrl": null,
            "page": 0,
            "rows": 0,
            "total": 0,
            "createDate": "2017-11-09 10:31:11",
            "dataName": null
          },
          {
            "modelSn": null,
            "datSn": null,
            "usrSn": null,
            "modelSetSn": null,
            "verSn": null,
            "createTime": null,
            "modelAddress": null,
            "modelName": null,
            "modelEnName": null,
            "modelSize": null,
            "isOpenSrc": "0",
            "comment": "人脸识别",
            "dataUrl": null,
            "page": 0,
            "rows": 0,
            "total": 0,
            "createDate": null,
            "dataName": null
          },
          null,
          null
        ]
      }

      |参数名|必选|类型|说明|
      |-----  |----- |----- |-----   |
      |modelAddress |String | 模型地址|  
      |isOpenSrc |String | 权限|
      |createDate |String | 时间|
      |dataUrl |String | 数据地址|


&copy;祥云创想





